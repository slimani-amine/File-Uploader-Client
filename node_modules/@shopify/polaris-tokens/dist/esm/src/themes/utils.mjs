import { slicedToArray as _slicedToArray } from '../../_virtual/_rollupPluginBabelHelpers.mjs';
import deepmerge from 'deepmerge';
import { createExact } from '../utilities.mjs';
import { metaThemeBase } from './base/index.mjs';

var createMetaThemePartial = createExact();
function createMetaTheme(metaThemePartial) {
  return deepmerge(metaThemeBase, metaThemePartial);
}
function flattenMetaTheme(metaTheme) {
  return Object.fromEntries(Object.values(metaTheme).flatMap(function (metaTokenGroup) {
    return Object.entries(metaTokenGroup).map(function (_ref5) {
      var _ref6 = _slicedToArray(_ref5, 2),
        tokenName = _ref6[0],
        metaTokenProperties = _ref6[1];
      return [tokenName, metaTokenProperties];
    });
  }));
}
function resolveMetaThemeRefs(metaTheme) {
  var flattenedMetaTheme = flattenMetaTheme(metaTheme);
  return Object.fromEntries(Object.entries(metaTheme).map(function (_ref7) {
    var _ref8 = _slicedToArray(_ref7, 2),
      tokenGroupName = _ref8[0],
      metaTokenGroup = _ref8[1];
    return [tokenGroupName, Object.fromEntries(Object.entries(metaTokenGroup).map(function (_ref9) {
      var _ref10 = _slicedToArray(_ref9, 2),
        tokenName = _ref10[0],
        metaTokenProperties = _ref10[1];
      var tokenValue = metaTokenProperties.value;
      while (tokenValue.startsWith('var(--p-')) {
        var tokenNameRef = tokenValue.slice(8, -1);
        tokenValue = flattenedMetaTheme[tokenNameRef].value;
      }
      return [tokenName, Object.assign(Object.assign({}, metaTokenProperties), {}, {
        value: tokenValue
      })];
    }))];
  }));
}

export { createMetaTheme, createMetaThemePartial, flattenMetaTheme, resolveMetaThemeRefs };
